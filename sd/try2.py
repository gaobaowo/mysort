from copy import deepcopy
from itertools import  combinations
from time import time

boara = [["5", "3", ".", ".", "7", ".", ".", ".", "."],
         ["6", ".", ".", "1", "9", "5", ".", ".", "."],
         [".", "9", "8", ".", ".", ".", ".", "6", "."],
         ["8", ".", ".", ".", "6", ".", ".", ".", "3"],
         ["4", ".", ".", "8", ".", "3", ".", ".", "1"],
         ["7", ".", ".", ".", "2", ".", ".", ".", "6"],
         [".", "6", ".", ".", ".", ".", "2", "8", "."],
         [".", ".", ".", "4", "1", "9", ".", ".", "5"],
         [".", ".", ".", ".", "8", ".", ".", "7", "9"]]

boarb = [['.', '5', '8', '.', '3', '.', '.', '2', '.'],
         ['4', '.', '2', '.', '.', '.', '9', '.', '5'],
         ['.', '.', '7', '.', '.', '.', '6', '8', '.'],
         ['2', '9', '.', '.', '5', '4', '.', '7', '.'],
         ['5', '.', '.', '.', '6', '2', '.', '.', '.'],
         ['.', '.', '3', '8', '1', '.', '2', '5', '.'],
         ['1', '.', '9', '.', '.', '3', '.', '6', '4'],
         ['8', '6', '5', '4', '9', '.', '1', '3', '.'],
         ['.', '7', '.', '.', '.', '6', '.', '.', '.']]

boar0 = [['7', '.', '.', '4', '.', '6', '.', '.', '.'],
         ['8', '.', '.', '9', '2', '.', '.', '.', '.'],
         ['.', '4', '.', '.', '.', '.', '.', '.', '2'],
         ['.', '6', '.', '.', '.', '.', '7', '.', '4'],
         ['.', '8', '.', '.', '.', '.', '.', '1', '9'],
         ['2', '.', '.', '6', '.', '.', '.', '.', '.'],
         ['.', '.', '3', '1', '.', '.', '.', '.', '6'],
         ['1', '.', '.', '2', '.', '.', '4', '7', '0'],
         ['.', '2', '.', '8', '3', '.', '.', '.', '5']]

board=deepcopy(boara)

s0 = {'1', '2', '3', '4', '5', '6', '7', '8', '9'}
rows = []
cols = []
board_dot = []
ns = []
for i in range(9):
    ns.append({'1', '2', '3', '4', '5', '6', '7', '8', '9'})
for i in range(9):
    rows.append(s0 - set(board[i]))
    col = []
    for j in range(9):
        col.append(board[j][i])
        ns[3 * (i // 3) + j // 3].discard(board[i][j])
        if board[i][j] == '.':
            board_dot.append([i, j, set()])
    cols.append(s0 - set(col))

print('&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&')
print(rows)
print(cols)
print(ns)
print(len(board_dot))
while len(board_dot):
    for item in board_dot:
        a = rows[item[0]] & cols[item[1]] & ns[3 * (item[0] // 3) + item[1] // 3]
        if len(a) == 1:
            b = a.pop()
            board[item[0]][item[1]] = b
            rows[item[0]].remove(b)
            cols[item[1]].remove(b)
            ns[3 * (item[0] // 3) + item[1] // 3].remove(b)
            board_dot.remove(item)

        else:
            item[2] = a
    print("==================================")
    print(len(board_dot),board_dot)
print("==================================")
for i in range(9):
    print(boara[i]," "*6,board[i])